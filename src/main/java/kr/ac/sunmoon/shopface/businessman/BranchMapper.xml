<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.ac.sunmoon.shopface.businessman.BranchMapper">
	<insert id="insert" parameterType="kr.ac.sunmoon.shopface.businessman.Branch">
		INSERT INTO BRANCH(NO, BUSINESSMAN_ID, NAME, PHONE, REGISTER_DATE, ADDRESS, STATE, APPROVAL_STATUS)
		VALUES(BRANCH_NO_SEQ.NEXTVAL, #{businessmanId}, #{name}, #{phone}, SYSDATE, #{address}, 'A', 'W')
	</insert>
	
	<select id="selectAll" parameterType="kr.ac.sunmoon.shopface.businessman.Branch" resultType="kr.ac.sunmoon.shopface.businessman.Branch">
		SELECT 
			 NO
			,BUSINESSMAN_ID
			,NAME
			,PHONE
			,TO_CHAR(REGISTER_DATE, 'YYYY-MM-DD') AS "REGISTER_DATE"
			,ADDRESS
			,STATE
			,APPROVAL_STATUS
		FROM BRANCH
		<where>
			<if test="businessmanId != null and businessmanId != ''">
				AND BUSINESSMAN_ID = #{businessmanId}
			</if>
			<if test="APPROVAL_STATUS != null">
				AND APPROBVAL_STATUS = #{approvalStatus}
			</if>
		</where>
	</select>
	
	<select id="select" parameterType="int" resultType="kr.ac.sunmoon.shopface.businessman.Branch">
		SELECT 
			 NO
			,BUSINESSMAN_ID
			,NAME
			,PHONE
			,TO_CHAR(REGISTER_DATE, 'YYYY-MM-DD') AS "REGISTER_DATE"
			,ADDRESS
			,STATE
			,APPROVAL_STATUS
		FROM BRANCH
		WHERE NO = #{no}
	</select>
	
	<update id="update" parameterType="kr.ac.sunmoon.shopface.businessman.Branch">
		UPDATE BRANCH
		<set>
			<if test="name != null and name != ''">
				NAME = #{name},
			</if> 
			<if test="address != null and address != ''">
				ADDRESS = #{address},
			</if>
			<if test="phone != null and phone != ''">
				PHONE = #{phone},
			</if>
			<if test="approvalStatus != null">
				APPROVAL_STATUS = #{approvalStatus},
			</if>
			<if test="state != null">
				state = #{state},
			</if>
			BUSINESS_LICENSE_PATH = #{businessLicensePath}
		</set>
		WHERE NO = #{no}
	</update>
	
	<delete id="delete" parameterType="kr.ac.sunmoon.shopface.businessman.Branch">
		DELETE FROM BRANCH
		WHERE NO = #{no}
	</delete>
</mapper>